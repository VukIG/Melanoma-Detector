import { View, Text, StyleSheet, Pressable } from "react-native";
import { useState } from "react";
import Svg, { SvgXml } from "react-native-svg";
import { launchImageLibrary } from "react-native-image-picker";

export const Gallery = ({ title }) => {
	const [showGallery, setShowGallery] = useState(false);
	const [declineGallery, setDeclineGallery] = useState(false);
	const [selectedPhoto, setSelectedPhoto] = useState(null);

	// testing states (delete)
	const [showCount, setShowCount] = useState(0);
	const [showDeclineCount, setShowDeclineCount] = useState(0);

	const openUserPhotos = () => {
		const imageOptions = {
			mediaType: "photo",
			includeBase64: false,
			maxHeight: 600,
			maxWidth: 600,
		};

		launchImageLibrary(options, (res) => {
			if(res.didCancel) {
				console.log("Canceled photo selection!");
			}
			else if(res.error) {
				console.log("Error message: ", res.error);
			}
			else{
				setSelectedPhoto({
					uri: res.uri,
					assets: res.assets,
				});
			}
		})
	};

	const openGallery = () => {
		console.log("API CALL TO OPEN GALLERY");
		setShowCount((p) => p + 1);
		setShowGallery((prev) => !prev);
	};

	const notNow = () => {
		console.log("DO NOT OPEN GALLERY");
		setShowDeclineCount((p) => p + 1);
		setDeclineGallery((prev) => !prev);
	};

	return (
		<View style={styles.container}>
			<Svg style={styles.svg}>
				<SvgXml xml={GallerySVG} />
			</Svg>

			<View style={styles.bottomContent}>
				<Text style={styles.titleText}>{title}</Text>
				<Text style={styles.description}>
					Lorem ipsum dolor sit amet consectetur adipisicing elit.
				</Text>
				<Pressable onPress={openGallery} style={styles.galleryBtn}>
					<Text style={styles.galleryBtnText}>Enable Gallery</Text>
				</Pressable>
				<Pressable onPress={notNow} style={styles.declineBtn}>
					<Text style={styles.declineBtnText}>Not now</Text>
				</Pressable>
				{showGallery ? <Text>Open up gallery: {showCount}</Text> : null}
				{declineGallery ? <Text>Leave this page: {showDeclineCount}</Text> : null}
			</View>
		</View>
	);
};

const styles = StyleSheet.create({
	svg: {
		width: 350,
		height: 350,
	},
	container: {
		display: "flex",
		justifyContent: "center",
		alignItems: "center",
		padding: 50,
	},
	bottomContent: {
		display: "flex",
		justifyContent: "center",
		alignItems: "center",
		top: 50,
	},
	titleText: {
		color: "#69acfb",
		fontSize: 30,
		fontWeight: "600",
	},
	description: {
		width: 200,
	},
	galleryBtn: {
		backgroundColor: "#47bffd",
		borderWidth: 2,
		borderRadius: 10,
		borderColor: "transparent",
		marginTop: 20,
		width: 200,
		display: "flex",
		justifyContent: "center",
		alignItems: "center",
	},
	galleryBtnText: {
		color: "#ffffff",
		padding: 10,
		fontWeight: "bold",
	},
	declineBtn: {
		backgroundColor: "#ffffff",
		borderWidth: 2,
		borderRadius: 10,
		borderColor: "#47bffd",
		marginTop: 20,
		width: 200,
		display: "flex",
		justifyContent: "center",
		alignItems: "center",
	},
	declineBtnText: {
		color: "#47bffd",
		padding: 10,
		fontWeight: "bold",
	},
});

// gallery photo (BETTER TO USE A PNG THAN SVG B/C IT'S LESS CPU INTENSIVE TO RENDER)
const GallerySVG = `<svg viewBox="0 0 500 500" xmlns="http://www.w3.org/2000/svg">
<defs>
  <clipPath id="clip0_16_745">
	<rect width="612" height="609" fill="white" transform="translate(-42 -149)"/>
  </clipPath>
</defs>
<g clip-path="url(#clip0_16_745)" transform="matrix(1.3677259683609007, 0, 0, 1.3677259683609007, -33.170387762343694, -129.94890025181917)" style="">
  <path d="M163.535 241.521C162.453 240.939 161.257 240.603 160.031 240.534C158.805 240.465 157.58 240.666 156.44 241.122C155.301 241.579 154.276 242.28 153.437 243.176C152.598 244.072 151.966 245.142 151.585 246.31L121.747 246.837L130.523 259.638L157.513 257.175C159.516 257.687 161.636 257.446 163.473 256.498C165.309 255.55 166.733 253.961 167.475 252.031C168.218 250.102 168.227 247.966 167.501 246.029C166.774 244.092 165.363 242.488 163.535 241.521Z" fill="#FFB8B8"/>
  <path d="M145.746 258.173C145.428 258.595 145.025 258.945 144.564 259.2C144.102 259.456 143.591 259.611 143.065 259.656L115.709 261.984C106.356 262.781 97.0283 260.152 89.4617 254.584L64.5286 236.244C63.0725 235.602 61.7569 234.679 60.6571 233.527C59.5573 232.376 58.6949 231.019 58.1191 229.535C57.5433 228.051 57.2654 226.467 57.3013 224.876C57.3372 223.285 57.6862 221.716 58.3284 220.26C58.9706 218.805 59.8934 217.49 61.0439 216.392C62.1945 215.294 63.5503 214.433 65.0338 213.86C66.5174 213.287 68.0996 213.012 69.69 213.051C71.2804 213.089 72.8478 213.442 74.3027 214.087L115.304 241.086L141.931 245.189C142.694 245.308 143.402 245.659 143.96 246.194C144.518 246.729 144.898 247.422 145.049 248.18L146.43 255.184C146.578 255.935 146.494 256.714 146.188 257.415C146.071 257.684 145.923 257.939 145.746 258.173Z" fill="white"/>
  <path d="M62.2697 201.455C73.5952 201.455 82.7763 192.264 82.7763 180.926C82.7763 169.587 73.5952 160.396 62.2697 160.396C50.9442 160.396 41.7631 169.587 41.7631 180.926C41.7631 192.264 50.9442 201.455 62.2697 201.455Z" fill="#FFB8B8"/>
  <path d="M70.5754 450.239L80.8116 450.238L85.6809 410.711L70.5737 410.712L70.5754 450.239Z" fill="#FFB8B8"/>
  <path d="M100.553 459.753L68.3826 459.754L68.382 447.311L88.1229 447.31C91.4194 447.31 94.5809 448.62 96.912 450.954C99.243 453.287 100.553 456.452 100.553 459.753Z" fill="white"/>
  <path d="M37.1784 450.239L47.4146 450.238L52.2839 410.711L37.1768 410.712L37.1784 450.239Z" fill="#FFB8B8"/>
  <path d="M67.1559 459.753L34.9856 459.754L34.985 447.311L54.7259 447.31C58.0224 447.31 61.1839 448.62 63.515 450.954C65.8461 453.287 67.1557 456.452 67.1559 459.753Z" fill="white"/>
  <path d="M33.6045 438.924C33.2518 438.521 32.9893 438.047 32.8345 437.534C32.6797 437.021 32.6362 436.481 32.707 435.95L50.6283 301.388L95.1537 308.958L99.9056 306.104L87.6176 433.777C87.5154 434.639 87.1193 435.439 86.4963 436.043C85.8733 436.646 85.0614 437.016 84.1976 437.09L70.7155 438.215C70.1794 438.26 69.6401 438.189 69.1338 438.007C68.6275 437.825 68.1662 437.537 67.7809 437.161C67.3957 436.785 67.0956 436.331 66.9009 435.829C66.7062 435.327 66.6214 434.789 66.6523 434.251L70.1429 373.449C70.149 373.345 70.1167 373.243 70.0521 373.163C69.9875 373.082 69.8953 373.028 69.7933 373.011C69.6913 372.995 69.5868 373.016 69.4999 373.072C69.413 373.129 69.35 373.215 69.323 373.315L52.0542 437.426C51.8383 438.224 51.3661 438.929 50.7106 439.431C50.0551 439.934 49.2525 440.207 48.4267 440.208H36.4313C35.896 440.208 35.3668 440.094 34.8792 439.872C34.3917 439.651 33.9571 439.328 33.6045 438.924Z" fill="#5EA8FF"/>
  <path d="M64.4403 310.807C63.9292 310.344 63.2722 310.074 62.5834 310.045C61.8946 310.017 61.2175 310.23 60.6696 310.649L51.7678 317.581C51.2834 317.959 50.7136 318.213 50.1085 318.319C49.5034 318.426 48.8815 318.382 48.2973 318.191C47.7131 318.001 47.1845 317.67 46.7578 317.228C46.3312 316.785 46.0196 316.244 45.8503 315.653C41.4839 300.344 31.5912 261.808 34.0283 234.686C35.4097 219.312 48.6704 207.628 63.5888 208.608C73.7879 209.289 80.4977 215.179 83.5318 226.115C90.9815 252.965 99.1685 302.216 100.734 311.817C100.858 312.561 100.753 313.326 100.435 314.011C100.117 314.695 99.5991 315.268 98.9502 315.652C94.7384 318.184 89.9262 319.539 85.0138 319.579C79.0698 319.579 71.9428 317.507 64.4403 310.807Z" fill="white"/>
  <path d="M67.7991 320.358C67.8988 319.133 67.7291 317.901 67.3018 316.75C66.8746 315.598 66.2002 314.553 65.3263 313.691C64.4523 312.828 63.4001 312.167 62.2436 311.756C61.0871 311.344 59.8545 311.191 58.6327 311.308L46.2158 284.148L37.9988 297.311L51.0498 321.084C51.382 323.126 52.4508 324.975 54.0537 326.281C55.6566 327.587 57.6822 328.259 59.7468 328.169C61.8114 328.08 63.7714 327.235 65.2555 325.795C66.7396 324.356 67.6446 322.421 67.7991 320.358Z" fill="#FFB8B8"/>
  <path d="M45.4296 310.689C44.9163 310.566 44.4346 310.336 44.0159 310.015C43.5971 309.693 43.2506 309.287 42.999 308.822L29.9248 284.658C25.4536 276.397 24.1319 266.791 26.2057 257.627L33.0342 227.433C33.0399 225.841 33.3591 224.265 33.9736 222.796C34.5881 221.327 35.4858 219.994 36.6155 218.873C37.7451 217.751 39.0844 216.864 40.5568 216.261C42.0292 215.658 43.6059 215.352 45.1967 215.36C46.7874 215.368 48.361 215.689 49.8275 216.306C51.294 216.923 52.6246 217.824 53.7432 218.956C54.8618 220.089 55.7465 221.431 56.3467 222.905C56.9468 224.38 57.2507 225.959 57.2408 227.552L48.9071 275.942L55.7983 302.005C55.9942 302.753 55.956 303.542 55.689 304.268C55.4219 304.993 54.9388 305.619 54.3049 306.06L48.4413 310.124C47.8122 310.559 47.0656 310.792 46.3008 310.792C46.0073 310.792 45.7149 310.758 45.4296 310.689Z" fill="white"/>
  <path opacity="0.2" d="M55.5768 247.959L48.0625 279.722L58.9165 306.47L51.4022 280.558L55.5768 247.959Z" fill="black"/>
  <path d="M59.9169 201.468C52.396 201.639 44.9641 196.956 41.5718 189.91C39.9153 186.335 39.2297 182.386 39.5841 178.461C39.9384 174.537 41.3202 170.775 43.59 167.555C45.8562 164.486 48.9499 162.128 52.5079 160.758C56.0659 159.387 59.9406 159.061 63.6771 159.818C67.8133 157.183 72.6224 155.409 77.4423 155.86C82.2622 156.311 87.0289 159.314 88.8313 164.027C90.6336 168.74 88.6973 174.952 84.2157 176.867C81.3425 178.095 78.0979 177.5 75.0317 177.005C71.9655 176.51 68.6207 176.186 65.9521 177.847C63.2835 179.507 62.084 183.959 64.4739 186.035C65.7514 187.214 66.6559 188.742 67.0756 190.43C67.4954 192.118 67.412 193.893 66.8358 195.534C65.6347 198.794 62.3563 201.413 59.9169 201.468Z" fill="#2F2E41"/>
  <path d="M364.194 286.695C363.488 284.737 362.196 283.043 360.494 281.845C358.792 280.647 356.763 280.003 354.683 280H146.106C144.779 279.999 143.464 280.261 142.238 280.769C141.012 281.277 139.897 282.023 138.959 282.962C138.02 283.902 137.276 285.017 136.768 286.245C136.261 287.473 135.999 288.789 136 290.117V450.357C136.004 453.039 137.07 455.61 138.964 457.507C140.859 459.403 143.427 460.471 146.106 460.474H354.683C357.362 460.471 359.93 459.403 361.825 457.507C363.719 455.61 364.785 453.039 364.789 450.357V290.117C364.791 288.951 364.59 287.793 364.194 286.695ZM363.6 450.357C363.597 452.724 362.657 454.993 360.985 456.666C359.313 458.34 357.047 459.281 354.683 459.284H146.106C143.742 459.281 141.476 458.34 139.804 456.666C138.132 454.993 137.192 452.724 137.189 450.357V290.117C137.192 287.751 138.132 285.482 139.804 283.808C141.476 282.135 143.742 281.193 146.106 281.19H354.683C357.047 281.193 359.313 282.135 360.985 283.808C362.657 285.482 363.597 287.751 363.6 290.117L363.6 450.357Z" fill="#3F3D56"/>
  <path d="M201.173 365.273C214.807 365.273 225.859 354.208 225.859 340.559C225.859 326.91 214.807 315.845 201.173 315.845C187.539 315.845 176.487 326.91 176.487 340.559C176.487 354.208 187.539 365.273 201.173 365.273Z" fill="#3F3D56"/>
  <path d="M278.585 416.718H157.484C157.332 416.719 157.18 416.707 157.031 416.682L185.669 367.021L214.307 317.36C214.656 316.742 215.163 316.227 215.777 315.869C216.39 315.511 217.087 315.322 217.797 315.322C218.507 315.322 219.204 315.511 219.817 315.869C220.431 316.227 220.938 316.742 221.287 317.36L259.727 384.013L261.568 387.202L278.585 416.718Z" fill="#CCCCCC"/>
  <path d="M346.014 416.717H241.271L261.568 387.202L263.029 385.076L289.478 346.611C291.212 344.09 295.383 343.933 297.422 346.136C297.559 346.286 297.686 346.445 297.803 346.611L346.014 416.717Z" fill="#CCCCCC"/>
</g>
</svg>`;
